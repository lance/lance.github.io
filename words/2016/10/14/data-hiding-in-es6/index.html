<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Lance Ball: StuffNThings"><link rel="alternate" type="application/rss+xml" title="RSS Feed for lanceball.com" href="/rss.xml"><title>Data Hiding in ES6 | Lance Ball</title><link rel="stylesheet" media="screen" href="/lib/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" media="screen" href="/css/site.css"><link rel="stylesheet" media="screen" href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600"><link rel="stylesheet" media="screen" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"></head><body><nav class="navbar navbar-default navbar-fixed-top"><div class="container"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only"></span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/"><span>Lance Ball</span></a></div><div class="navbar-collapse collapse" id="navbar"><ul class="nav navbar-nav"><li><a href="https://github.com/lance">GitHub</a></li><li><a href="http://twitter.com/lanceball">Twitter</a></li><li><a href="http://www.linkedin.com/in/lanceball">LinkedIn</a></li><li><a href="http://tumblr.lanceball.com">Tumblr</a></li></ul></div></div></nav><div class="container" id="content"><div class="page-header right"> I'm a Software Developer. I work for&nbsp;<a href="http://redhat.com">Red Hat</a></div><div class="article"><div class="metadata"><h1 class="title">Data Hiding in ES6</h1><div class="date">Thu Oct 13 2016</div></div><hr><div class="contents"><p>For a lot of my early career, I was an OO developer. I genuflected regularly in
front of the altar of data encapsulation, object heirarchies and static typing.
And the syntax. Oh the syntax!</p>
<p>But I have changed, of course, and so much of the dogma and ceremony that
I participated in during those times has come to seem a lot less important
than it was 20 years ago. Languages, and developers evolve. But that doesn&#39;t
mean there aren&#39;t some really good lessons to learn.</p>
<p>Take, for instance, data encapsulation.</p>
<!-- More -->
<p>When I first began to seriously look at Javascript as a language, data
encapsulation - or the lack of it - was one of the things that really stuck
in my old OO craw. While I loved the simplicity of the <code>{}</code> data structure,
I hated the fact that most properties I chose to add to it were typically
just there - sticking out for everyone to see and perhaps corrupt. The language
didn&#39;t make it very easy to keep this data protected.</p>
<p>Take a look at how this simplistic approach to the <code>{}</code> data structure
might cause some real headaches. Here we have a <code>productCatalog()</code> lookup
function that returns a <code>Product</code> data object. It might look something like
this:</p>
<p><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-9ec60d02ee0eb30530c9c2d12055b82db581fbb13b64b807fd63df9cd276d21b.css"><div id="gist40910913" class="gist">    <div class="gist-file">      <div class="gist-data">        <div class="js-gist-file-update-container js-task-list-container file-box">  <div id="file-es6-data-hiding-ex1-js" class="file">      <div itemprop="text" class="blob-wrapper data type-javascript">      <table class="highlight tab-size js-file-line-container" data-tab-size="8">      <tr>        <td id="file-es6-data-hiding-ex1-js-L1" class="blob-num js-line-number" data-line-number="1"></td>        <td id="file-es6-data-hiding-ex1-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">&gt;</span> <span class="pl-k">var</span> product <span class="pl-k">=</span> <span class="pl-en">productCatalog</span>(<span class="pl-s"><span class="pl-pds">&#39;</span>widget-a<span class="pl-pds">&#39;</span></span>);</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex1-js-L2" class="blob-num js-line-number" data-line-number="2"></td>        <td id="file-es6-data-hiding-ex1-js-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-k">&gt;</span> <span class="pl-en">console</span>.<span class="pl-c1">log</span>(product);</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex1-js-L3" class="blob-num js-line-number" data-line-number="3"></td>        <td id="file-es6-data-hiding-ex1-js-LC3" class="blob-code blob-code-inner js-file-line">Product { id<span class="pl-k">:</span> <span class="pl-c1">2340847</span>,</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex1-js-L4" class="blob-num js-line-number" data-line-number="4"></td>        <td id="file-es6-data-hiding-ex1-js-LC4" class="blob-code blob-code-inner js-file-line">  name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">&#39;</span>widget-a<span class="pl-pds">&#39;</span></span>,</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex1-js-L5" class="blob-num js-line-number" data-line-number="5"></td>        <td id="file-es6-data-hiding-ex1-js-LC5" class="blob-code blob-code-inner js-file-line">  description<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">&#39;</span>what a widget!<span class="pl-pds">&#39;</span></span>,</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex1-js-L6" class="blob-num js-line-number" data-line-number="6"></td>        <td id="file-es6-data-hiding-ex1-js-LC6" class="blob-code blob-code-inner js-file-line">  related<span class="pl-k">:</span> [<span class="pl-c1">Function</span>] }</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex1-js-L7" class="blob-num js-line-number" data-line-number="7"></td>        <td id="file-es6-data-hiding-ex1-js-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-k">&gt;</span></td>      </tr></table>  </div>  </div>  </div>      </div>      <div class="gist-meta">        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110/raw/f9bc5039ded0ea91ddf03b2b0442bb39baa07d15/es6-data-hiding-ex1.js" style="float:right">view raw</a>        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110#file-es6-data-hiding-ex1-js">es6-data-hiding-ex1.js</a>        hosted with &#10084; by <a href="https://github.com">GitHub</a>      </div>    </div></div></p>
<p>Notice that the object returned here contains a function, <code>related()</code> which
will find the set of products related to this one using this object&#39;s <code>id</code>
or <code>name</code> property. But those properties are just there hanging on to the
returned object by their fingernails. What if some evil bit of code came along
and did this: <code>product.id = 0x00034</code> just to see what would happen? How
would the <code>related()</code> function handle that? We just don&#39;t know.</p>
<p>There are ways to deal with this of course. One of the great things
about Javascript is how flexible it can be. Maybe the developer who wrote
the <code>productCatalog()</code> function knew some of these tricks. Here&#39;s one way
to handle it using Javascript&#39;s <code>Object.defineProperty</code> function.</p>
<p><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-9ec60d02ee0eb30530c9c2d12055b82db581fbb13b64b807fd63df9cd276d21b.css"><div id="gist40910913" class="gist">    <div class="gist-file">      <div class="gist-data">        <div class="js-gist-file-update-container js-task-list-container file-box">  <div id="file-es6-data-hiding-ex2-js" class="file">      <div itemprop="text" class="blob-wrapper data type-javascript">      <table class="highlight tab-size js-file-line-container" data-tab-size="8">      <tr>        <td id="file-es6-data-hiding-ex2-js-L1" class="blob-num js-line-number" data-line-number="1"></td>        <td id="file-es6-data-hiding-ex2-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">productCatalog</span>( <span class="pl-smi">name</span> ) {</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L2" class="blob-num js-line-number" data-line-number="2"></td>        <td id="file-es6-data-hiding-ex2-js-LC2" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">if</span> (<span class="pl-en">findProduct</span>(name)) {</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L3" class="blob-num js-line-number" data-line-number="3"></td>        <td id="file-es6-data-hiding-ex2-js-LC3" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-en">Product</span>(name);</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L4" class="blob-num js-line-number" data-line-number="4"></td>        <td id="file-es6-data-hiding-ex2-js-LC4" class="blob-code blob-code-inner js-file-line">  }</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L5" class="blob-num js-line-number" data-line-number="5"></td>        <td id="file-es6-data-hiding-ex2-js-LC5" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">return</span> <span class="pl-c1">null</span>;</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L6" class="blob-num js-line-number" data-line-number="6"></td>        <td id="file-es6-data-hiding-ex2-js-LC6" class="blob-code blob-code-inner js-file-line">}</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L7" class="blob-num js-line-number" data-line-number="7"></td>        <td id="file-es6-data-hiding-ex2-js-LC7" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L8" class="blob-num js-line-number" data-line-number="8"></td>        <td id="file-es6-data-hiding-ex2-js-LC8" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">Product</span> (<span class="pl-smi">name</span>) {</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L9" class="blob-num js-line-number" data-line-number="9"></td>        <td id="file-es6-data-hiding-ex2-js-LC9" class="blob-code blob-code-inner js-file-line">  <span class="pl-v">this</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> name;</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L10" class="blob-num js-line-number" data-line-number="10"></td>        <td id="file-es6-data-hiding-ex2-js-LC10" class="blob-code blob-code-inner js-file-line">  <span class="pl-c">// lookup the product and populate</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L11" class="blob-num js-line-number" data-line-number="11"></td>        <td id="file-es6-data-hiding-ex2-js-LC11" class="blob-code blob-code-inner js-file-line">  <span class="pl-c">// this object&#39;s properties with appropriate values.</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L12" class="blob-num js-line-number" data-line-number="12"></td>        <td id="file-es6-data-hiding-ex2-js-LC12" class="blob-code blob-code-inner js-file-line">  </td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L13" class="blob-num js-line-number" data-line-number="13"></td>        <td id="file-es6-data-hiding-ex2-js-LC13" class="blob-code blob-code-inner js-file-line">  <span class="pl-c">// Don&#39;t allow client code to modify our ID</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L14" class="blob-num js-line-number" data-line-number="14"></td>        <td id="file-es6-data-hiding-ex2-js-LC14" class="blob-code blob-code-inner js-file-line">  <span class="pl-c1">Object</span>.<span class="pl-en">defineProperty</span>(<span class="pl-v">this</span>, <span class="pl-s"><span class="pl-pds">&#39;</span>id<span class="pl-pds">&#39;</span></span>, {</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L15" class="blob-num js-line-number" data-line-number="15"></td>        <td id="file-es6-data-hiding-ex2-js-LC15" class="blob-code blob-code-inner js-file-line">    enumerable<span class="pl-k">:</span> <span class="pl-c1">false</span>,</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L16" class="blob-num js-line-number" data-line-number="16"></td>        <td id="file-es6-data-hiding-ex2-js-LC16" class="blob-code blob-code-inner js-file-line">    configurable<span class="pl-k">:</span> <span class="pl-c1">false</span>,</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L17" class="blob-num js-line-number" data-line-number="17"></td>        <td id="file-es6-data-hiding-ex2-js-LC17" class="blob-code blob-code-inner js-file-line">    writable<span class="pl-k">:</span> <span class="pl-c1">false</span>,</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L18" class="blob-num js-line-number" data-line-number="18"></td>        <td id="file-es6-data-hiding-ex2-js-LC18" class="blob-code blob-code-inner js-file-line">    value<span class="pl-k">:</span> <span class="pl-c1">2340847</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L19" class="blob-num js-line-number" data-line-number="19"></td>        <td id="file-es6-data-hiding-ex2-js-LC19" class="blob-code blob-code-inner js-file-line">  });</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L20" class="blob-num js-line-number" data-line-number="20"></td>        <td id="file-es6-data-hiding-ex2-js-LC20" class="blob-code blob-code-inner js-file-line">  </td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L21" class="blob-num js-line-number" data-line-number="21"></td>        <td id="file-es6-data-hiding-ex2-js-LC21" class="blob-code blob-code-inner js-file-line">}</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex2-js-L22" class="blob-num js-line-number" data-line-number="22"></td>        <td id="file-es6-data-hiding-ex2-js-LC22" class="blob-code blob-code-inner js-file-line"></td>      </tr></table>  </div>  </div>  </div>      </div>      <div class="gist-meta">        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110/raw/f9bc5039ded0ea91ddf03b2b0442bb39baa07d15/es6-data-hiding-ex2.js" style="float:right">view raw</a>        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110#file-es6-data-hiding-ex2-js">es6-data-hiding-ex2.js</a>        hosted with &#10084; by <a href="https://github.com">GitHub</a>      </div>    </div></div></p>
<p><strong>But... eeewwww.</strong></p>
<p>Let&#39;s see how well that worked. At first things look great -
no <code>id</code> property on basic inspection. And if you do try to modify it,
the value can&#39;t be changed. Yay!</p>
<p><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-9ec60d02ee0eb30530c9c2d12055b82db581fbb13b64b807fd63df9cd276d21b.css"><div id="gist40910913" class="gist">    <div class="gist-file">      <div class="gist-data">        <div class="js-gist-file-update-container js-task-list-container file-box">  <div id="file-es6-data-hiding-ex3-js" class="file">      <div itemprop="text" class="blob-wrapper data type-javascript">      <table class="highlight tab-size js-file-line-container" data-tab-size="8">      <tr>        <td id="file-es6-data-hiding-ex3-js-L1" class="blob-num js-line-number" data-line-number="1"></td>        <td id="file-es6-data-hiding-ex3-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">&gt;</span> <span class="pl-en">console</span>.<span class="pl-c1">log</span>(productObject);</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex3-js-L2" class="blob-num js-line-number" data-line-number="2"></td>        <td id="file-es6-data-hiding-ex3-js-LC2" class="blob-code blob-code-inner js-file-line">Product { name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">&#39;</span>widget-a<span class="pl-pds">&#39;</span></span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex3-js-L3" class="blob-num js-line-number" data-line-number="3"></td>        <td id="file-es6-data-hiding-ex3-js-LC3" class="blob-code blob-code-inner js-file-line">  description<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">&#39;</span>what a widget!<span class="pl-pds">&#39;</span></span>,</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex3-js-L4" class="blob-num js-line-number" data-line-number="4"></td>        <td id="file-es6-data-hiding-ex3-js-LC4" class="blob-code blob-code-inner js-file-line">  related<span class="pl-k">:</span> [<span class="pl-c1">Function</span>] }</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex3-js-L5" class="blob-num js-line-number" data-line-number="5"></td>        <td id="file-es6-data-hiding-ex3-js-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-k">&gt;</span> <span class="pl-c">// OK, this looks good - the object doesn&#39;t have a visible ID property. Nice!</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex3-js-L6" class="blob-num js-line-number" data-line-number="6"></td>        <td id="file-es6-data-hiding-ex3-js-LC6" class="blob-code blob-code-inner js-file-line"><span class="pl-k">&gt;</span> <span class="pl-c">// But there is one there. Can I change it?</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex3-js-L7" class="blob-num js-line-number" data-line-number="7"></td>        <td id="file-es6-data-hiding-ex3-js-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-k">&gt;</span> <span class="pl-smi">productObject</span>.<span class="pl-c1">id</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex3-js-L8" class="blob-num js-line-number" data-line-number="8"></td>        <td id="file-es6-data-hiding-ex3-js-LC8" class="blob-code blob-code-inner js-file-line"><span class="pl-c1">2340847</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex3-js-L9" class="blob-num js-line-number" data-line-number="9"></td>        <td id="file-es6-data-hiding-ex3-js-LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-k">&gt;</span> <span class="pl-smi">productObject</span>.<span class="pl-c1">id</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>foo<span class="pl-pds">&#39;</span></span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex3-js-L10" class="blob-num js-line-number" data-line-number="10"></td>        <td id="file-es6-data-hiding-ex3-js-LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-s"><span class="pl-pds">&#39;</span>foo<span class="pl-pds">&#39;</span></span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex3-js-L11" class="blob-num js-line-number" data-line-number="11"></td>        <td id="file-es6-data-hiding-ex3-js-LC11" class="blob-code blob-code-inner js-file-line"><span class="pl-k">&gt;</span> <span class="pl-smi">productObject</span>.<span class="pl-c1">id</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex3-js-L12" class="blob-num js-line-number" data-line-number="12"></td>        <td id="file-es6-data-hiding-ex3-js-LC12" class="blob-code blob-code-inner js-file-line"><span class="pl-c1">2340847</span></td>      </tr></table>  </div>  </div>  </div>      </div>      <div class="gist-meta">        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110/raw/f9bc5039ded0ea91ddf03b2b0442bb39baa07d15/es6-data-hiding-ex3.js" style="float:right">view raw</a>        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110#file-es6-data-hiding-ex3-js">es6-data-hiding-ex3.js</a>        hosted with &#10084; by <a href="https://github.com">GitHub</a>      </div>    </div></div></p>
<p>But darn it. The property name appears in the <code>Object.getOwnPropertyNames()</code>
result. This isn&#39;t terrible, but we&#39;re not doing a great job of hiding data.</p>
<p><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-9ec60d02ee0eb30530c9c2d12055b82db581fbb13b64b807fd63df9cd276d21b.css"><div id="gist40910913" class="gist">    <div class="gist-file">      <div class="gist-data">        <div class="js-gist-file-update-container js-task-list-container file-box">  <div id="file-es6-data-hiding-ex4-js" class="file">      <div itemprop="text" class="blob-wrapper data type-javascript">      <table class="highlight tab-size js-file-line-container" data-tab-size="8">      <tr>        <td id="file-es6-data-hiding-ex4-js-L1" class="blob-num js-line-number" data-line-number="1"></td>        <td id="file-es6-data-hiding-ex4-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">&gt;</span> <span class="pl-c1">Object</span>.<span class="pl-en">getOwnPropertyNames</span>(productObject)</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex4-js-L2" class="blob-num js-line-number" data-line-number="2"></td>        <td id="file-es6-data-hiding-ex4-js-LC2" class="blob-code blob-code-inner js-file-line">[ <span class="pl-s"><span class="pl-pds">&#39;</span>id<span class="pl-pds">&#39;</span></span>, <span class="pl-s"><span class="pl-pds">&#39;</span>name<span class="pl-pds">&#39;</span></span>, <span class="pl-s"><span class="pl-pds">&#39;</span>description<span class="pl-pds">&#39;</span></span>, <span class="pl-s"><span class="pl-pds">&#39;</span>related<span class="pl-pds">&#39;</span></span> ]</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex4-js-L3" class="blob-num js-line-number" data-line-number="3"></td>        <td id="file-es6-data-hiding-ex4-js-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">&gt;</span> <span class="pl-c">// ruh roh</span></td>      </tr></table>  </div>  </div>  </div>      </div>      <div class="gist-meta">        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110/raw/f9bc5039ded0ea91ddf03b2b0442bb39baa07d15/es6-data-hiding-ex4.js" style="float:right">view raw</a>        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110#file-es6-data-hiding-ex4-js">es6-data-hiding-ex4.js</a>        hosted with &#10084; by <a href="https://github.com">GitHub</a>      </div>    </div></div></p>
<p>What I&#39;d really like is for the <code>Product</code> object to have a reference to the
<code>id</code> but no way for client code to read it or even see it. Closures, for example,
provide a way to do this. But that&#39;s really an entirely separate blog post, and what
I really want to talk about here is ES6.</p>
<h2 id="ecmascript-2015">EcmaScript 2015</h2>
<p>ES6 or EcmaScript 2015, as it is formally known, introduces lots of great
new language features. I wish I had time to tell you about them all, but
for now, I&#39;ll just focus on one subject. Data Hiding and Encapsulation.</p>
<p>There are a few new ways developers can approach this problem now, when
using modern Javascript interpreters with ES6 features available.</p>
<h3 id="getters">Getters</h3>
<p>First let&#39;s take a look at Getters. ES6 getters allow you to easily
use a function that makes a property read only. And since a getter is a
function, the value could even be the result of some calculation. But
that&#39;s not the point here.</p>
<p>Here&#39;s how you would use a getter in ES6 and how you could achieve the
same functionality in ES5. The new syntax is way better.</p>
<p><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-9ec60d02ee0eb30530c9c2d12055b82db581fbb13b64b807fd63df9cd276d21b.css"><div id="gist40910913" class="gist">    <div class="gist-file">      <div class="gist-data">        <div class="js-gist-file-update-container js-task-list-container file-box">  <div id="file-es6-data-hiding-ex5-js" class="file">      <div itemprop="text" class="blob-wrapper data type-javascript">      <table class="highlight tab-size js-file-line-container" data-tab-size="8">      <tr>        <td id="file-es6-data-hiding-ex5-js-L1" class="blob-num js-line-number" data-line-number="1"></td>        <td id="file-es6-data-hiding-ex5-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c">// The ES6 way</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L2" class="blob-num js-line-number" data-line-number="2"></td>        <td id="file-es6-data-hiding-ex5-js-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-k">let</span> product <span class="pl-k">=</span> {</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L3" class="blob-num js-line-number" data-line-number="3"></td>        <td id="file-es6-data-hiding-ex5-js-LC3" class="blob-code blob-code-inner js-file-line"> <span class="pl-k">get</span> <span class="pl-en">id</span> () { <span class="pl-k">return</span> <span class="pl-c1">2340847</span>; }</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L4" class="blob-num js-line-number" data-line-number="4"></td>        <td id="file-es6-data-hiding-ex5-js-LC4" class="blob-code blob-code-inner js-file-line">};</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L5" class="blob-num js-line-number" data-line-number="5"></td>        <td id="file-es6-data-hiding-ex5-js-LC5" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L6" class="blob-num js-line-number" data-line-number="6"></td>        <td id="file-es6-data-hiding-ex5-js-LC6" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">product</span>.<span class="pl-c1">id</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L7" class="blob-num js-line-number" data-line-number="7"></td>        <td id="file-es6-data-hiding-ex5-js-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-c">// 2340847</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L8" class="blob-num js-line-number" data-line-number="8"></td>        <td id="file-es6-data-hiding-ex5-js-LC8" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">product</span>.<span class="pl-c1">id</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>foo<span class="pl-pds">&#39;</span></span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L9" class="blob-num js-line-number" data-line-number="9"></td>        <td id="file-es6-data-hiding-ex5-js-LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">product</span>.<span class="pl-c1">id</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L10" class="blob-num js-line-number" data-line-number="10"></td>        <td id="file-es6-data-hiding-ex5-js-LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-c">// 2340847</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L11" class="blob-num js-line-number" data-line-number="11"></td>        <td id="file-es6-data-hiding-ex5-js-LC11" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L12" class="blob-num js-line-number" data-line-number="12"></td>        <td id="file-es6-data-hiding-ex5-js-LC12" class="blob-code blob-code-inner js-file-line"><span class="pl-c">// The old way</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L13" class="blob-num js-line-number" data-line-number="13"></td>        <td id="file-es6-data-hiding-ex5-js-LC13" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> product <span class="pl-k">=</span> {};</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L14" class="blob-num js-line-number" data-line-number="14"></td>        <td id="file-es6-data-hiding-ex5-js-LC14" class="blob-code blob-code-inner js-file-line"><span class="pl-c1">Object</span>.<span class="pl-en">defineProperty</span>(product, <span class="pl-s"><span class="pl-pds">&#39;</span>id<span class="pl-pds">&#39;</span></span>, {</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L15" class="blob-num js-line-number" data-line-number="15"></td>        <td id="file-es6-data-hiding-ex5-js-LC15" class="blob-code blob-code-inner js-file-line">  <span class="pl-en">get</span><span class="pl-k">:</span> <span class="pl-k">function</span>() { <span class="pl-k">return</span> <span class="pl-c1">2340847</span>; },</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L16" class="blob-num js-line-number" data-line-number="16"></td>        <td id="file-es6-data-hiding-ex5-js-LC16" class="blob-code blob-code-inner js-file-line">  enumerable<span class="pl-k">:</span> <span class="pl-c1">false</span>,</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L17" class="blob-num js-line-number" data-line-number="17"></td>        <td id="file-es6-data-hiding-ex5-js-LC17" class="blob-code blob-code-inner js-file-line">  configurable<span class="pl-k">:</span> <span class="pl-c1">false</span>,</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex5-js-L18" class="blob-num js-line-number" data-line-number="18"></td>        <td id="file-es6-data-hiding-ex5-js-LC18" class="blob-code blob-code-inner js-file-line">});</td>      </tr></table>  </div>  </div>  </div>      </div>      <div class="gist-meta">        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110/raw/f9bc5039ded0ea91ddf03b2b0442bb39baa07d15/es6-data-hiding-ex5.js" style="float:right">view raw</a>        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110#file-es6-data-hiding-ex5-js">es6-data-hiding-ex5.js</a>        hosted with &#10084; by <a href="https://github.com">GitHub</a>      </div>    </div></div></p>
<p>But this still doesn&#39;t really get what we want. There are two tools
besides closures we can use to really and truly hide our data. Those are
<code>WeakMap</code> and <code>Symbol</code>. Let&#39;s look at the <code>WeakMap</code> first.</p>
<h3 id="weakmaps">WeakMaps</h3>
<p>The <code>WeakMap</code> is a new data structure in ES6. It acts a lot like
a regular map data structure. They are <code>iterable</code>, and have getters and
setters for objects. What makes them unique is that the keys are weakly
referenced. This means, essentially, that when the only remaining reference
to the key is the key itself, the entry is removed from the map. Here&#39;s
how you can use the <code>WeakMap</code> data structure to effectively hide private
class data.</p>
<p><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-9ec60d02ee0eb30530c9c2d12055b82db581fbb13b64b807fd63df9cd276d21b.css"><div id="gist40910913" class="gist">    <div class="gist-file">      <div class="gist-data">        <div class="js-gist-file-update-container js-task-list-container file-box">  <div id="file-es6-data-hiding-ex6-js" class="file">      <div itemprop="text" class="blob-wrapper data type-javascript">      <table class="highlight tab-size js-file-line-container" data-tab-size="8">      <tr>        <td id="file-es6-data-hiding-ex6-js-L1" class="blob-num js-line-number" data-line-number="1"></td>        <td id="file-es6-data-hiding-ex6-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">const</span> <span class="pl-c1">privates</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">WeakMap</span>();</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex6-js-L2" class="blob-num js-line-number" data-line-number="2"></td>        <td id="file-es6-data-hiding-ex6-js-LC2" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex6-js-L3" class="blob-num js-line-number" data-line-number="3"></td>        <td id="file-es6-data-hiding-ex6-js-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">class</span> <span class="pl-en">Product</span> {</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex6-js-L4" class="blob-num js-line-number" data-line-number="4"></td>        <td id="file-es6-data-hiding-ex6-js-LC4" class="blob-code blob-code-inner js-file-line">  <span class="pl-en">constructor </span>(<span class="pl-smi">name</span>) {</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex6-js-L5" class="blob-num js-line-number" data-line-number="5"></td>        <td id="file-es6-data-hiding-ex6-js-LC5" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">this</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> name;</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex6-js-L6" class="blob-num js-line-number" data-line-number="6"></td>        <td id="file-es6-data-hiding-ex6-js-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-smi">privates</span>.<span class="pl-c1">set</span>(<span class="pl-v">this</span>, {</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex6-js-L7" class="blob-num js-line-number" data-line-number="7"></td>        <td id="file-es6-data-hiding-ex6-js-LC7" class="blob-code blob-code-inner js-file-line">      id<span class="pl-k">:</span> <span class="pl-c1">2340847</span></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex6-js-L8" class="blob-num js-line-number" data-line-number="8"></td>        <td id="file-es6-data-hiding-ex6-js-LC8" class="blob-code blob-code-inner js-file-line">    });</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex6-js-L9" class="blob-num js-line-number" data-line-number="9"></td>        <td id="file-es6-data-hiding-ex6-js-LC9" class="blob-code blob-code-inner js-file-line">  }</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex6-js-L10" class="blob-num js-line-number" data-line-number="10"></td>        <td id="file-es6-data-hiding-ex6-js-LC10" class="blob-code blob-code-inner js-file-line">  </td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex6-js-L11" class="blob-num js-line-number" data-line-number="11"></td>        <td id="file-es6-data-hiding-ex6-js-LC11" class="blob-code blob-code-inner js-file-line">  <span class="pl-en">related</span> () {</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex6-js-L12" class="blob-num js-line-number" data-line-number="12"></td>        <td id="file-es6-data-hiding-ex6-js-LC12" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> <span class="pl-en">lookupRelatedStuff</span>( <span class="pl-smi">privates</span>.<span class="pl-c1">get</span>(<span class="pl-v">this</span>) );</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex6-js-L13" class="blob-num js-line-number" data-line-number="13"></td>        <td id="file-es6-data-hiding-ex6-js-LC13" class="blob-code blob-code-inner js-file-line">  }</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex6-js-L14" class="blob-num js-line-number" data-line-number="14"></td>        <td id="file-es6-data-hiding-ex6-js-LC14" class="blob-code blob-code-inner js-file-line">}</td>      </tr></table>  </div>  </div>  </div>      </div>      <div class="gist-meta">        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110/raw/f9bc5039ded0ea91ddf03b2b0442bb39baa07d15/es6-data-hiding-ex6.js" style="float:right">view raw</a>        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110#file-es6-data-hiding-ex6-js">es6-data-hiding-ex6.js</a>        hosted with &#10084; by <a href="https://github.com">GitHub</a>      </div>    </div></div></p>
<p>Assuming this code is in a module that exports the <code>productCatalog</code>
function, there is no way for client code to see or modify the <code>id</code>
property. Success!</p>
<p>I like this approach. It&#39;s elegant and simple. The only real drawback I
have found with this is performance. It&#39;s pretty expensive to do these
<code>WeakMap</code> lookups to get a handle on a property. So if performance is
paramount. Consider using <code>Symbol</code> as property keys.</p>
<h3 id="symbols">Symbols</h3>
<p>I have found that using properties whose keys are <code>Symbol</code>s, while not
as elegant as <code>WeakMap</code> in my opinion is my preferred data hiding
technique, because it&#39;s just so much faster.</p>
<p>One of the interesting things about <code>Symbol</code> is that each <code>Symbol</code>
is unique. If we can keep the <code>Symbol</code> private within our module,
then we don&#39;t have to worry about client code accessing the property.
Here&#39;s how our <code>Product</code> object would look if we took this approach.</p>
<p><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-9ec60d02ee0eb30530c9c2d12055b82db581fbb13b64b807fd63df9cd276d21b.css"><div id="gist40910913" class="gist">    <div class="gist-file">      <div class="gist-data">        <div class="js-gist-file-update-container js-task-list-container file-box">  <div id="file-es6-data-hiding-ex7-js" class="file">      <div itemprop="text" class="blob-wrapper data type-javascript">      <table class="highlight tab-size js-file-line-container" data-tab-size="8">      <tr>        <td id="file-es6-data-hiding-ex7-js-L1" class="blob-num js-line-number" data-line-number="1"></td>        <td id="file-es6-data-hiding-ex7-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">const</span> <span class="pl-c1">ID</span> <span class="pl-k">=</span> <span class="pl-c1">Symbol</span>(<span class="pl-s"><span class="pl-pds">&#39;</span>id<span class="pl-pds">&#39;</span></span>);</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex7-js-L2" class="blob-num js-line-number" data-line-number="2"></td>        <td id="file-es6-data-hiding-ex7-js-LC2" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex7-js-L3" class="blob-num js-line-number" data-line-number="3"></td>        <td id="file-es6-data-hiding-ex7-js-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">class</span> <span class="pl-en">Product</span> {</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex7-js-L4" class="blob-num js-line-number" data-line-number="4"></td>        <td id="file-es6-data-hiding-ex7-js-LC4" class="blob-code blob-code-inner js-file-line">  <span class="pl-en">constructor </span>(<span class="pl-smi">name</span>) {</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex7-js-L5" class="blob-num js-line-number" data-line-number="5"></td>        <td id="file-es6-data-hiding-ex7-js-LC5" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">this</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> name;</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex7-js-L6" class="blob-num js-line-number" data-line-number="6"></td>        <td id="file-es6-data-hiding-ex7-js-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">this</span>[<span class="pl-c1">ID</span>] <span class="pl-k">=</span> <span class="pl-c1">2340847</span>;</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex7-js-L7" class="blob-num js-line-number" data-line-number="7"></td>        <td id="file-es6-data-hiding-ex7-js-LC7" class="blob-code blob-code-inner js-file-line">  }</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex7-js-L8" class="blob-num js-line-number" data-line-number="8"></td>        <td id="file-es6-data-hiding-ex7-js-LC8" class="blob-code blob-code-inner js-file-line">  <span class="pl-en">related</span> () {</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex7-js-L9" class="blob-num js-line-number" data-line-number="9"></td>        <td id="file-es6-data-hiding-ex7-js-LC9" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> <span class="pl-en">lookupRelatedStuff</span>( <span class="pl-v">this</span>[<span class="pl-c1">ID</span>] );</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex7-js-L10" class="blob-num js-line-number" data-line-number="10"></td>        <td id="file-es6-data-hiding-ex7-js-LC10" class="blob-code blob-code-inner js-file-line">  }</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex7-js-L11" class="blob-num js-line-number" data-line-number="11"></td>        <td id="file-es6-data-hiding-ex7-js-LC11" class="blob-code blob-code-inner js-file-line">}</td>      </tr></table>  </div>  </div>  </div>      </div>      <div class="gist-meta">        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110/raw/f9bc5039ded0ea91ddf03b2b0442bb39baa07d15/es6-data-hiding-ex7.js" style="float:right">view raw</a>        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110#file-es6-data-hiding-ex7-js">es6-data-hiding-ex7.js</a>        hosted with &#10084; by <a href="https://github.com">GitHub</a>      </div>    </div></div></p>
<p>Additionally, when you use a <code>Symbol</code> for a property key, the property
does not appear in the list of properties returned from
<code>Object.getOwnPropertyNames()</code>. This is nice. The downside is that
the property leaks when using <code>Reflect.ownKeys()</code>.</p>
<p><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-9ec60d02ee0eb30530c9c2d12055b82db581fbb13b64b807fd63df9cd276d21b.css"><div id="gist40910913" class="gist">    <div class="gist-file">      <div class="gist-data">        <div class="js-gist-file-update-container js-task-list-container file-box">  <div id="file-es6-data-hiding-ex8-js" class="file">      <div itemprop="text" class="blob-wrapper data type-javascript">      <table class="highlight tab-size js-file-line-container" data-tab-size="8">      <tr>        <td id="file-es6-data-hiding-ex8-js-L1" class="blob-num js-line-number" data-line-number="1"></td>        <td id="file-es6-data-hiding-ex8-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">const</span> <span class="pl-c1">product</span> <span class="pl-k">=</span> <span class="pl-en">productCatalog</span>(<span class="pl-s"><span class="pl-pds">&#39;</span>a-widget<span class="pl-pds">&#39;</span></span>);</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex8-js-L2" class="blob-num js-line-number" data-line-number="2"></td>        <td id="file-es6-data-hiding-ex8-js-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-c1">Reflect</span>.<span class="pl-en">ownKeys</span>(product));</td>      </tr>      <tr>        <td id="file-es6-data-hiding-ex8-js-L3" class="blob-num js-line-number" data-line-number="3"></td>        <td id="file-es6-data-hiding-ex8-js-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-c">// [ &#39;name&#39;, Symbol(id) ]</span></td>      </tr></table>  </div>  </div>  </div>      </div>      <div class="gist-meta">        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110/raw/f9bc5039ded0ea91ddf03b2b0442bb39baa07d15/es6-data-hiding-ex8.js" style="float:right">view raw</a>        <a href="https://gist.github.com/lance/0aa47a11aefd4f2c1ef21c034e5b0110#file-es6-data-hiding-ex8-js">es6-data-hiding-ex8.js</a>        hosted with &#10084; by <a href="https://github.com">GitHub</a>      </div>    </div></div></p>
<p>But I can live with that when performance matters. For
<a href="https://npmjs.com/package/fidelity">Fidelity</a>, we found that moving
from <code>WeakMap</code> to <code>Symbol</code> for private data gave us a measurable, and
quite significant performance boost.</p>
</div><hr></div></div><footer id="footer"><div class="footer"><p class="text-center">&copy; Lance Ball 2016</p><p class="text-center">If you want to contact me and don't already know how, check out all of
those links at the top. I'm on the social medias.
</p></div></footer><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="/lib/bootstrap/js/bootstrap.min.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-373972-2', 'auto');
ga('send', 'pageview');</script></body></html>